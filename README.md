
# Ассемблер и интерпретатор УВМ

Данный проект реализует ассемблер и интерпретатор для учебной виртуальной машины (УВМ). Ассемблер переводит текстовые инструкции в бинарный формат, а интерпретатор выполняет команды из бинарного файла.

---

## **Функционал**

### **Ассемблер**
- Преобразует текстовые инструкции в бинарный файл.
- Логирует инструкции в CSV-формате с описанием и бинарным кодом.

### **Интерпретатор**
- Выполняет бинарный файл.
- Работает с 8 регистрами и памятью размером 1024 ячейки.
- Выводит содержимое регистров и памяти в CSV-файл.

---

## **Команды УВМ**
1. **Загрузка константы** (`opcode: 41`): Загрузка значения в регистр.  
   Пример: `41 1 100` → Бинарный код: `29 64 00 01`.

2. **Чтение из памяти** (`opcode: 79`): Чтение значения из памяти в регистр.  
   Пример: `79 3 100` → Бинарный код: `4F 64 00 03`.

3. **Запись в память** (`opcode: 168`): Запись значения из регистра в память.  
   Пример: `168 100 1` → Бинарный код: `A8 64 00 01`.

4. **Унарная операция: `popcnt`** (`opcode: 226`): Подсчет единичных битов.  
   Пример: `226 2 3` → Бинарный код: `E2 02 03`.

5. **Сброс регистров** (`opcode: 201`): Установка всех регистров в 0.  
   Пример: `201` → Бинарный код: `C9`.

---

## **Использование**

### **Ассемблер**
Команда для сборки программы:  
```bash
python uvm.py assemble <входной_файл> <выходной_файл> <лог>
```
- **`<входной_файл>`**: Текстовый файл с инструкциями.  
- **`<выходной_файл>`**: Файл с бинарным кодом.  
- **`<лог>`**: CSV-файл с логом сборки.  

### **Интерпретатор**
Команда для выполнения программы:  
```bash
python uvm.py run <бинарный_файл> <результат> <начало_памяти> <конец_памяти>
```
- **`<бинарный_файл>`**: Файл с бинарным кодом.  
- **`<результат>`**: CSV-файл с результатами выполнения.  
- **`<начало_памяти>`**, **`<конец_памяти>`**: Диапазон памяти для вывода.

---

## **Пример**

### Исходный файл (`program.txt`):
```txt
41 1 100       # Загрузка 100 в регистр 1
168 100 1      # Запись 100 в память по адресу 100
79 3 100       # Чтение из памяти (адрес 100) в регистр 3
226 2 3        # popcnt для регистра 2, результат по адресу из регистра 3
201            # Сброс регистров
```

### Сборка программы:
```bash
python uvm.py assemble program.txt program.bin log.csv
```

### Выполнение программы:
```bash
python uvm.py run program.bin result.csv 0 200
```

---

## **Формат файлов**

### **Лог ассемблера (`log.csv`):**
```csv
Инструкция,Бинарный код,Описание
41 1 100,29 64 00 01,Загрузка константы 100 в регистр 1
168 100 1,A8 64 00 01,Запись значения 100 в память
79 3 100,4F 64 00 03,Чтение из памяти в регистр 3
226 2 3,E2 02 03,popcnt: регистр B=3, регистр C=2
201,C9,Сброс регистров
```

### **Результат интерпретатора (`result.csv`):**
```csv
Адрес/Регистр,Значение
Регистр 0,0
Регистр 1,100
...
Память 100,100
...
```

